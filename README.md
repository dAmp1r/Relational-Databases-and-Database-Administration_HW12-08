# Relational-Databases-and-Database-Administration_HW12-08

*Резервное копирование баз данных - Горбунов Д.Н.*

Задание 1.

1.1 Дифференциальный бэкап - для востановления используем последний полный бэкап и дифференциальный бэкап за предыдущий день.

1.2 Инкрементный бэкап - создание бэкапов с фиксацией изменения данных каждый час.

Задание 2.

- для создание резервной копии                
```pg_dump ИмяБазы > /tmp/ИмяБазы.dump```

- для востановления определеной базы                     
```pg_restore -d ИмяБазы /tmp/ИмяБазы.dump```
  
Задание 3.

- для создание резервной копии            
```mysqldump -u пользователь -p ИмяБазы > ИмяБазы.sql```

Создание инкрементных резервных копий с помощью двоичного журнала                     

MySQL поддерживает инкрементные резервные копии: следует запустить сервер с опцией --log-bin , чтобы включить двоичное журналирование, см. раздел 6.4.4. Двоичные файлы журнала предоставляют Вам информацию, Вы должны тиражировать изменения в базу данных, что делается после точки, в которой Вы выполняли резервное копирование. Когда Вы хотите сделать инкрементное резервное копирование (содержащее все изменения, которые произошли, начиная с последнего полного или инкрементного резервного копирования), следует ротировать двоичный журнал, используя FLUSH LOGS. Вы должны скопировать в резервную копию все двоичные журналы, которые находятся в диапазоне от момента последнего полного или инкрементного резервного копирования до предпоследнего. Эти двоичные журналы и есть инкрементное резервное копирование, во время восстановления Вы применяете их как объяснено в разделе 8.5. В следующий раз, когда Вы делаете полное резервное копирование, следует также ротировать журнал с помощью FLUSH LOGS или mysqldump --flush-logs .

Инкрементальная резервная копия содержит только ту информацию, которая изменилась после создания предыдущей резервной копии. Это существенно уменьшает размер резервных копий и позволяет вам делать такие резервные копии очень часто.     

В MySQL вы можете реализовать создание инкрементальных резервных копий с помощью резервного копирования двоичных файлов журнала. Все транзакции, применяемые к серверу MySQL, последовательно записываются в двоичные файлы журнала. Следовательно, вы всегда можете восстановить исходную базу данных из этих файлов      

Каждая инкрементальная копия содержит изменения, которые были созданы с момента последней резервной копии, но самая первая резервная копия должна быть полной копией. Вам необходимо создать полную резервную копию через mysqldump, используя параметры --flush-log и --delete-master-logs, ––delete-master-logs удалит старые двоичные файлы журнала, а --flush-log инициализирует запись нового двоичного файла журнала. Результаты заархивируем.

```mysqldump --flush-logs --delete-master-logs --single-transaction --all-databases | gzip > /var/backups/mysql/$(date +%d-%m-%Y_%H-%M-%S)-inc.gz```
